import{r as e,y as t,f as a,z as l,q as o,v as i,A as s}from"./index.eabbe37b.js";import{_ as r}from"./ConfirmDialogue.9510fbd6.js";import{C as n}from"./ckeditor.5faa1adb.js";import{o as d,c,b as p,q as u,u as m,M as h,t as g,d as b,F as x,n as f,s as v,f as y,r as w}from"./vendor.fe91043f.js";import"./PopupModal.5cad3434.js";const k={name:"Management",components:{ConfirmDialogue:r},data:()=>({errorMessage:null,status:"Idle",editor:n,editorData:"<h1>Write your content here...</h1>",editorConfig:{ckfinder:{uploadUrl:"https://example.com/ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Images&responseType=json",options:{resourceType:"Images"}}},ref:e.collection("Insights"),insightsData:null,document:{time_input:null,author:null,contentType:null,data:{content:null,title:null,header:null,date:null}},video:{tempVideoUrl:null,videoData:null},image:{tempImageUrl:[],imageData:[]},cover:{tempImageUrl:null,imageData:null}}),created(){this.insightsData=t(),console.log(this.insightsData)},methods:{checkdata(){console.log(this.editorData);var e=this.editorData.split("<p>-break-</p>");e.forEach((e=>{console.log(e)})),this.document.description=e,console.log(this.document)},previewImage(e){let t,a=e.target.files;for(console.log(a.length),t=0;t<a.length;t++)this.image.imageData.push(a[t]),this.image.tempImageUrl.push(URL.createObjectURL(this.image.imageData[t]))},previewImageMain(e){let t=e.target.files[0];this.cover.imageData=t,this.cover.tempImageUrl=URL.createObjectURL(t)},convertToSlug:e=>e.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),previewVideo(e){this.video.videoData=e.target.files[0],this.video.tempVideoUrl=URL.createObjectURL(this.video.videoData)},async upload(){this.document.time_input=a.firestore.Timestamp.now(),this.status="Process";let e=a.storage().ref("/Insights"),t=e.child(`${this.cover.imageData.name} in Content: ${this.document.name}`);await t.put(this.cover.imageData);let o=await t.getDownloadURL();this.document.data.image_main=o;var i=this.convertToSlug(this.document.data.title);if("Article"==this.document.contentType){this.document.data.images=[];let a=this.editorData.split("<p>-break-</p>");this.document.data.content=a,console.log(this.document);var s=this.image.imageData.length;this.image.imageData.forEach((async a=>{t=e.child(`${a.name} in Content: ${this.document.data.title}`),await t.put(a),o=await t.getDownloadURL(),console.log(o),this.document.data.images.push(o),setTimeout((()=>{s-=1,console.log("not done"),0===s&&(console.log("done"),console.log(this.document),l(i,this.document),this.status="Success",setTimeout((()=>{this.status="Idle"}),5e3),this.reset())}),1)}))}else{e=a.storage().ref("/Insights"),t=e.child(`${this.video.videoData.name} in Content: ${this.document.data.title}`),await t.put(this.video.videoData),o=await t.getDownloadURL(),this.document.data.content=o,t=e.child(`${this.cover.imageData.name} in Content: ${this.document.data.title}`),await t.put(this.cover.imageData),o=await t.getDownloadURL(),this.document.data.image_main=o;let s=this.editorData.split("<p>-break-</p>");this.document.data.description=s,console.log(this.document),l(i,this.document),this.status="Success",setTimeout((()=>{this.status="Idle"}),5e3),this.reset()}},reset(){this.resetContent(),this.resetContentMain(),document.getElementById("main-form").reset();for(const e in this.document)if("data"===e)for(const t in this.document[e])this.document[e][t]=null;else"contentType"===e||(this.document[e]=null)},resetContent(){this.image.imageData=[],this.image.tempImageUrl=[],document.getElementById("input-file").value="",this.document.data.content=null;for(const e in this.video)this.video[e]=null},resetContentMain(){this.cover.imageData=null,this.cover.tempImageUrl=null,document.getElementById("input-file-main").value=""},showData(e){e.target.classList.add("hidden"),e.target.previousSibling.classList.remove("hidden"),e.target.nextSibling.classList.remove("hidden")},hideData(e){e.target.classList.add("hidden"),e.target.nextSibling.classList.remove("hidden"),e.target.nextSibling.nextSibling.classList.add("hidden")},editInsight(e){var t=e.target[0].value;this.$router.push(`/admin/insight/${t}`)},setForm(e){this.document=e},async _delete(e){let t=e.target[0].value,a=e.target[0].getAttribute("data-title"),l=e.target[0].getAttribute("data-author");if(await this.$refs.confirmDialogue.show({title:`Delete '${a}' by ${l}`,message:"Are you sure you want to delete this Content? It cannot be undone.",okButton:"Delete"})){const e=[];let a=await o(t);a=a.data;for(const t in a)a[t].includes("https://firebasestorage.googleapis.com")?e.push(a[t]):"images"==t&&a[t].forEach((t=>{e.push(t)}));e.forEach((async e=>{try{await i(e)}catch(t){console.log(t)}})),s(t)}},setHeightTextarea(e){e.target.style.height="200px",e.target.style.height=e.target.scrollHeight+"px"}}},D={class:"bg-black-1 lg:px-40 px-5 text-white font-ibm"},C=p("div",{class:"grid grid-cols-1 gap-5 bg-black-1 border-b-2 border-black-2 "},[p("div",{class:"py-10 text-teal-2"},[p("h1",{class:"text-h3 font-medium"},"Insight"),p("h1",{class:"text-sh3"},"The information put here will be displayed on public")])],-1),I={class:"grid lg:grid-cols-1 grid-cols-1 gap-5"},U={class:"h-auto flex flex-col "},T=p("h1",{class:"text-sh3 py-5 mx-auto text-teal-2"},"General Information",-1),V={class:"h-screen flex flex-col"},L=p("label",{class:"text-btn"},"Author:",-1),S=p("label",{class:"text-btn mt-6"},"Date:",-1),M=p("label",{class:"text-btn mt-6"},"Title:",-1),R=p("label",{class:"text-btn mt-6"},"(Optional) Header:",-1),A=p("label",{class:"text-btn mt-6"},"Type:",-1),$={class:"flex flex-row items-center space-x-5 mt-6 px-3"},j=p("label",{class:"inline",for:""},"Article",-1),q={class:"flex flex-row items-center space-x-5 mt-6 px-3"},E=p("label",{class:"inline",for:""},"Video",-1),_={key:0,class:"flex flex-col"},P={class:"text-sh3 py-5 mx-auto text-teal-2"},H={class:"h-auto lg:ml-4 flex flex-col"},B=p("label",{class:"text-btn"},"Content:",-1),O={key:0,class:"py-6 text-black-1"},F={class:"py-6 flex flex-col space-y-2"},N=p("h1",{class:"text-white"},"Upload Cover/Main Image",-1),z={class:"mt-4 cursor-pointer px-2 py-2"},G={key:0,class:"flex"},Q={class:"py-6 flex flex-col space-y-2"},W=p("h1",{class:"text-white"},"Upload Content Image",-1),J={class:"mt-4 cursor-pointer px-2 py-2"},K={key:0,class:"flex"},X={key:1,class:"py-6 flex flex-col space-y-2 "},Y={class:"py-6 flex flex-col space-y-2"},Z=p("h1",{class:"text-white"},"Upload Cover/Main Image",-1),ee={class:"mt-4 cursor-pointer px-2 py-2"},te={key:0,class:"flex"},ae=p("h1",null,"Upload Videos",-1),le={class:"mt-4 cursor-pointer px-2 py-2"},oe={key:0},ie={class:"text-sm",for:""},se={width:"500",height:"281",controls:""},re={class:"text-black-1"},ne={key:2,class:"h-auto flex flex-col px-5 py-10 space-y-5"},de=p("input",{class:"bg-teal-2 w-grid px-10 rounded text-white hover:bg-teal-3 text-center",type:"submit",value:"Submit"},null,-1),ce=p("label",null,null,-1),pe={key:3,class:"bg-black-1 border-t border-yellow-500 text-yellow-500 px-4 py-3",role:"alert"},ue=p("p",{class:"font-medium"},"Processing...",-1),me=p("p",{class:"font-medium"},"Please don't terminate the progress or do anything else.",-1),he={key:4,class:"bg-black-1 border-t border-teal-3 text-teal-3 px-4 py-3",role:"alert"},ge=p("p",{class:"font-medium"},"Data saved!",-1),be={key:5,class:"bg-black-1 border-t border-red-600 text-red-600 px-4 py-3",role:"alert"},xe=p("p",{class:"font-medium"},"Saving data failed! Try again...",-1),fe={class:"bg-black-2 rounded-lg h-auto py-10 w-100 mt-10"},ve=p("h1",{class:"text-lg text-center font-bold m-5"},"Data Table",-1),ye={class:"table-auto rounded-lg m-5 w-11/12 mx-auto bg-gray-800 text-gray-200"},we=p("thead",null,[p("tr",null,[p("th",{class:"p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Author"),p("th",{class:"timeInputCol p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Input Time"),p("th",{class:"p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Type"),p("th",{class:"p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Title"),p("th",{class:"p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Content"),p("th",{class:"p-3 font-bold uppercase   border border-gray-300 hidden md:table-cell"},"Actions")])],-1),ke={class:"w-full md:w-auto p-3  text-left border border-b block md:table-cell relative md:static"},De=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Author",-1),Ce={class:"timeInputCol w-full md:w-auto p-3  border border-b text-left block md:table-cell relative md:static"},Ie=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Input Time",-1),Ue={class:"w-full md:w-auto p-3  border border-b text-left block md:table-cell relative md:static"},Te=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Type",-1),Ve={class:"w-full md:w-auto p-3  border border-b text-left block md:table-cell relative md:static"},Le=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Title",-1),Se={class:"w-full md:w-auto p-3  border border-b text-left block md:table-cell relative md:static"},Me=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Content",-1),Re={class:"dataCell hidden max-w-screen-sm"},Ae={class:"w-4/5"},$e={class:"w-4/5"},je=y("Content: "),qe={key:0,class:"w-4/5"},Ee={class:"w-full md:w-auto p-3 flex border border-b text-left md:table-cell relative md:static"},_e=p("span",{class:"md:hidden hover:hidden absolute top-0 right-0 bg-gray-700 px-2 py-1 text-xs font-bold uppercase"},"Actions",-1),Pe=p("input",{type:"submit",class:"editCell bg-yellow-600 w-grid px-2 mr-2 rounded text-white hover:bg-yellow-400",value:"Edit"},null,-1),He=p("input",{type:"submit",class:"deleteCell bg-red-600 w-grid mt-0 md:mt-2 px-2 rounded text-white hover:bg-red-400",value:"Delete"},null,-1);k.render=function(e,t,a,l,o,i){const s=w("ckeditor"),r=w("confirm-dialogue");return d(),c("main",D,[C,p("form",{id:"main-form",onSubmit:t[17]||(t[17]=v(((...e)=>i.upload&&i.upload(...e)),["prevent"]))},[p("div",I,[p("div",U,[T,p("div",V,[L,u(p("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.document.author=e),type:"text",id:"authorName",class:"block mt-2 lg:w-4/5 w-4/5 lg:h-11 h-6 lg:text-lg text-sm lg:pt-3 pt-1 bg-black-1 border-t-0 border-l-0 border-r-0 border-b-2 focus:ring-transparent focus:border-black-3 focus:border-opacity-80 hover:border-opacity-80 border-black-3 border-opacity-50 text-black-3",placeholder:"Name",required:""},null,512),[[m,this.document.author]]),S,u(p("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>this.document.data.date=e),type:"date",id:"dateContent",class:"block mt-2 lg:w-4/5 w-4/5 lg:h-11 h-6 lg:text-lg text-sm lg:pt-3 pt-1 bg-black-1 border-t-0 border-l-0 border-r-0 border-b-2 focus:ring-transparent focus:border-black-3 focus:border-opacity-80 hover:border-opacity-80 border-black-3 border-opacity-50 text-black-3",required:""},null,512),[[m,this.document.data.date]]),M,u(p("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.document.data.title=e),type:"text",id:"titleContent",class:"block mt-2 lg:w-4/5 w-4/5 lg:h-11 h-6 lg:text-lg text-sm lg:pt-3 pt-1 bg-black-1 border-t-0 border-l-0 border-r-0 border-b-2 focus:ring-transparent focus:border-black-3 focus:border-opacity-80 hover:border-opacity-80 border-black-3 border-opacity-50 text-black-3",placeholder:"Title",required:""},null,512),[[m,this.document.data.title]]),R,u(p("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>this.document.data.header=e),type:"text",id:"titleContent",class:"block mt-2 lg:w-4/5 w-4/5 lg:h-11 h-6 lg:text-lg text-sm lg:pt-3 pt-1 bg-black-1 border-t-0 border-l-0 border-r-0 border-b-2 focus:ring-transparent focus:border-black-3 focus:border-opacity-80 hover:border-opacity-80 border-black-3 border-opacity-50 text-black-3",placeholder:"Header"},null,512),[[m,this.document.data.header]]),A,p("div",$,[u(p("input",{name:"contentType",type:"radio",id:"one",value:"Article","onUpdate:modelValue":t[5]||(t[5]=e=>o.document.contentType=e)},null,512),[[h,o.document.contentType]]),j]),p("div",q,[u(p("input",{name:"contentType",type:"radio",id:"one",value:"Video","onUpdate:modelValue":t[6]||(t[6]=e=>o.document.contentType=e)},null,512),[[h,o.document.contentType]]),E])])]),o.document.contentType?(d(),c("div",_,[p("h1",P,g(o.document.contentType),1),p("div",H,[B,"Article"===o.document.contentType?(d(),c("div",O,[p("div",F,[N,p("div",z,[p("input",{onChange:t[7]||(t[7]=(...e)=>i.previewImageMain&&i.previewImageMain(...e)),type:"file",accept:"image/*",class:"input-file",id:"input-file-main",required:""},null,32),p("button",{type:"button",class:"bg-red-600 w-grid px-10 rounded text-white hover:bg-red-400",onClick:t[8]||(t[8]=(...e)=>i.resetContentMain&&i.resetContentMain(...e))},"Reset Image")]),this.cover.tempImageUrl?(d(),c("div",G,[p("img",{src:this.cover.tempImageUrl,style:{width:"20vw","margin-right":"20px"}},null,8,["src"])])):b("",!0)]),p("div",Q,[W,p("div",J,[p("input",{onChange:t[9]||(t[9]=(...e)=>i.previewImage&&i.previewImage(...e)),type:"file",accept:"image/*",class:"input-file",id:"input-file",multiple:"",required:""},null,32),p("button",{type:"button",class:"bg-red-600 w-grid px-10 rounded text-white hover:bg-red-400",onClick:t[10]||(t[10]=(...e)=>i.resetContent&&i.resetContent(...e))},"Reset Image")]),this.image.tempImageUrl?(d(),c("div",K,[(d(!0),c(x,null,f(this.image.tempImageUrl,(e=>(d(),c("div",{key:e},[p("img",{src:e,style:{width:"20vw","margin-right":"20px"}},null,8,["src"])])))),128))])):b("",!0)])])):b("",!0),"Video"===o.document.contentType?(d(),c("div",X,[p("div",Y,[Z,p("div",ee,[p("input",{onChange:t[11]||(t[11]=(...e)=>i.previewImageMain&&i.previewImageMain(...e)),type:"file",accept:"image/*",class:"input-file",id:"input-file-main",required:""},null,32),p("button",{type:"button",class:"bg-red-600 w-grid px-10 rounded text-white hover:bg-red-400",onClick:t[12]||(t[12]=(...e)=>i.resetContentMain&&i.resetContentMain(...e))},"Reset Image")]),this.cover.tempImageUrl?(d(),c("div",te,[p("img",{src:this.cover.tempImageUrl,style:{width:"20vw","margin-right":"20px"}},null,8,["src"])])):b("",!0)]),ae,p("div",le,[null===this.video.tempVideoUrl?(d(),c("input",{key:0,onChange:t[13]||(t[13]=(...e)=>i.previewVideo&&i.previewVideo(...e)),type:"file",accept:"video/*",class:"input-file",required:""},null,32)):b("",!0),this.video.tempVideoUrl?(d(),c("button",{key:1,class:"bg-red-600 w-grid px-10 rounded text-white hover:bg-red-400",onClick:t[14]||(t[14]=(...e)=>i.resetContent&&i.resetContent(...e))},"Reset Video")):b("",!0)]),this.video.tempVideoUrl?(d(),c("div",oe,[p("label",ie,g(this.video.videoData.name),1),p("video",se,[p("source",{src:this.video.tempVideoUrl,type:"video/mp4"},null,8,["src"])])])):b("",!0)])):b("",!0),p("div",re,[p(s,{editor:o.editor,modelValue:o.editorData,"onUpdate:modelValue":t[15]||(t[15]=e=>o.editorData=e),config:o.editorConfig},null,8,["editor","modelValue","config"])]),"Process"!=this.status?(d(),c("div",ne,[de,p("button",{class:"bg-red-600 w-grid px-10 rounded text-white hover:bg-red-400",onClick:t[16]||(t[16]=(...e)=>i.reset&&i.reset(...e))},"Reset"),ce])):b("",!0),"Process"===this.status?(d(),c("div",pe,[ue,me])):b("",!0),"Success"===this.status?(d(),c("div",he,[ge])):b("",!0),"Error"===this.status?(d(),c("div",be,[xe])):b("",!0)])])):b("",!0)])],32),p("div",null,[p(r,{ref:"confirmDialogue"},null,512)]),p("div",fe,[ve,p("table",ye,[we,p("tbody",null,[(d(!0),c(x,null,f(o.insightsData,(({id:e,author:a,time_input:l,contentType:o,data:s})=>(d(),c("tr",{key:l,class:"md:hover:bg-gray-700 align-top flex md:table-row flex-row md:flex-row flex-wrap md:flex-no-wrap mb-10 md:mb-0"},[p("td",ke,[De,y(" "+g(a),1)]),p("td",Ce,[Ie,y(" "+g(l.toDate().toDateString())+", "+g(l.toDate().toLocaleTimeString("en-US")),1)]),p("td",Ue,[Te,y(" "+g(o),1)]),p("td",Ve,[Le,y(" "+g(s.title),1)]),p("td",Se,[Me,p("button",{class:"hideDataCell hidden bg-green-600 w-grid px-2 rounded text-white hover:bg-green-400",onClick:t[18]||(t[18]=(...e)=>i.hideData&&i.hideData(...e))},"Hide"),p("button",{class:"showDataCell bg-green-600 w-grid px-2 rounded text-white hover:bg-green-400",onClick:t[19]||(t[19]=(...e)=>i.showData&&i.showData(...e))},"Preview"),p("div",Re,[p("p",Ae,"Header: "+g(s.header),1),p("p",$e,"Date: "+g(s.date),1),je,"Article"==o?(d(),c("p",qe,g(s.content),1)):(d(),c("a",{key:1,class:"w-4/5 underline",href:s.content},"Video",8,["href"]))])]),p("td",Ee,[_e,p("form",{onSubmit:t[20]||(t[20]=v(((...e)=>i.editInsight&&i.editInsight(...e)),["prevent"]))},[p("input",{type:"text",class:"hidden",value:e},null,8,["value"]),Pe],32),p("form",{onSubmit:t[21]||(t[21]=v(((...e)=>i._delete&&i._delete(...e)),["prevent"]))},[p("input",{"data-contentType":o,"data-content":s.content,"data-title":s.title,"data-author":a,type:"text",class:"hidden",value:e},null,8,["data-contentType","data-content","data-title","data-author","value"]),He],32)])])))),128))])])])])};export default k;
